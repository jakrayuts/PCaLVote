<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Back to School Voting</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
body{
    font-family:'Prompt',sans-serif;
    background: linear-gradient(135deg,#fbc2eb,#a6c1ee);
}
.glass{
    background: rgba(255,255,255,0.85);
    backdrop-filter: blur(15px);
    box-shadow: 0 15px 40px rgba(0,0,0,0.08);
}
.active-btn{
    transform:scale(1.05);
    box-shadow:0 0 0 3px rgba(255,255,255,0.7) inset;
}
button{
    transition: all .2s ease;
}
button:active{
    transform:scale(.96);
}
</style>
</head>

<body class="min-h-screen flex items-center justify-center p-4 text-gray-700">

<div class="w-full max-w-4xl">

<h1 class="text-3xl md:text-4xl font-bold text-center mb-8 text-white drop-shadow-lg">
üéì Back to School Voting
</h1>

<!-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ù‡πà‡∏≤‡∏¢ -->
<div class="flex justify-center gap-4 mb-8 flex-wrap">
<button id="femaleBtn" onclick="setGroup('female')"
class="px-6 py-3 rounded-2xl bg-pink-200 text-pink-800 hover:bg-pink-300 font-semibold shadow-md">
üë© ‡∏ù‡πà‡∏≤‡∏¢‡∏´‡∏ç‡∏¥‡∏á
</button>

<button id="maleBtn" onclick="setGroup('male')"
class="px-6 py-3 rounded-2xl bg-blue-200 text-blue-800 hover:bg-blue-300 font-semibold shadow-md">
üë® ‡∏ù‡πà‡∏≤‡∏¢‡∏ä‡∏≤‡∏¢
</button>
</div>

<!-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
<div class="glass rounded-3xl p-6 mb-6">

<div class="grid grid-cols-1 md:grid-cols-3 gap-4">

<div>
<label class="text-sm font-semibold">‡∏ù‡πà‡∏≤‡∏¢</label>
<input id="groupDisplay" disabled
class="w-full mt-1 bg-gray-100 px-3 py-2 rounded-xl">
</div>

<div>
<label class="text-sm font-semibold">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏Å‡∏ß‡∏î</label>
<select id="contestant"
class="w-full mt-1 bg-gray-100 px-3 py-2 rounded-xl"></select>
</div>

<div>
<label class="text-sm font-semibold">‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£</label>
<select id="judge"
class="w-full mt-1 bg-gray-100 px-3 py-2 rounded-xl">
<option>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠...</option>
</select>
</div>

</div>
</div>

<!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô -->
<div class="glass rounded-3xl p-6">

<div id="scoreTable" class="space-y-4"></div>

<!-- ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° -->
<div class="mt-8">
<div class="flex justify-between mb-2 font-semibold text-lg">
<span>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°</span>
<span id="totalScore">0 / 100</span>
</div>

<div class="w-full bg-white/50 rounded-full h-4">
<div id="progressBar"
class="bg-gradient-to-r from-pink-300 via-purple-300 to-blue-300 h-4 rounded-full transition-all duration-500"
style="width:0%"></div>
</div>
</div>

<!-- ‡∏õ‡∏∏‡πà‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å -->
<div class="text-center mt-8">
<button id="submitBtn"
onclick="submitScore()"
class="px-10 py-4 bg-gradient-to-r from-green-300 to-green-500 text-white rounded-2xl shadow-lg text-lg font-semibold hover:scale-105">
‚úî ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
</button>
</div>

</div>
</div>

<script>

let currentGroup="";

const criteria=[
{name:'‡∏Å‡∏≤‡∏£‡πÅ‡∏ï‡πà‡∏á‡∏Å‡∏≤‡∏¢‡∏ï‡∏≤‡∏° Theme "Back to School"',max:20},
{name:"‡∏Å‡∏≤‡∏£‡πÅ‡∏ï‡πà‡∏á‡∏Å‡∏≤‡∏¢‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå",max:20},
{name:"‡∏Ñ‡∏ß‡∏≤‡∏°‡πÇ‡∏î‡∏î‡πÄ‡∏î‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏Å‡∏ß‡∏î",max:15},
{name:"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏û‡∏¥‡πÄ‡∏®‡∏©‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à",max:15},
{name:"‡∏ö‡∏∏‡∏Ñ‡∏•‡∏¥‡∏Å‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏≠‡∏Å",max:15},
{name:"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à / ‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô / ‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°",max:15}
];

function loadContestants(){
let html="";
for(let i=1;i<=10;i++){
html+=`<option value="${i}">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç ${i}</option>`;
}
document.getElementById("contestant").innerHTML=html;
}

function loadTable(){
let html="";
criteria.forEach((c,i)=>{
html+=`
<div class="bg-white/70 p-4 rounded-2xl shadow-sm">
<div class="flex justify-between text-sm mb-2 font-medium">
<span>${i+1}. ${c.name}</span>
<span>‡πÄ‡∏ï‡πá‡∏° ${c.max}</span>
</div>

<input type="number"
min="0"
max="${c.max}"
oninput="validateInput(this)"
class="scoreInput w-full bg-white border px-3 py-2 rounded-xl text-center text-lg">
</div>
`;
});
document.getElementById("scoreTable").innerHTML=html;
}

function validateInput(input){
let max=parseInt(input.max);
let value=parseInt(input.value)||0;
if(value>max) input.value=max;
if(value<0) input.value=0;
calculateTotal();
}

function calculateTotal(){
let total=0;
document.querySelectorAll(".scoreInput").forEach(i=>{
total+=parseInt(i.value)||0;
});
if(total>100) total=100;
document.getElementById("totalScore").innerText=total+" / 100";
document.getElementById("progressBar").style.width=total+"%";
}

function setGroup(group){
currentGroup=group;
document.getElementById("groupDisplay").value=
group==="female"?"‡∏ù‡πà‡∏≤‡∏¢‡∏´‡∏ç‡∏¥‡∏á":"‡∏ù‡πà‡∏≤‡∏¢‡∏ä‡∏≤‡∏¢";

femaleBtn.classList.remove("active-btn");
maleBtn.classList.remove("active-btn");

group==="female"?
femaleBtn.classList.add("active-btn"):
maleBtn.classList.add("active-btn");
}

async function submitScore(){

if(currentGroup===""){
Swal.fire({icon:'warning',title:'‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡πà‡∏≠‡∏ô'});
return;
}

if(document.getElementById("judge").value===""){
Swal.fire({icon:'warning',title:'‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£'});
return;
}

let inputs=document.querySelectorAll(".scoreInput");
let scores=[];
inputs.forEach(i=>scores.push(parseInt(i.value)||0));

let total=scores.reduce((a,b)=>a+b,0);

if(total===0){
Swal.fire({icon:'warning',title:'‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Å‡πà‡∏≠‡∏ô'});
return;
}

const btn=document.getElementById("submitBtn");
btn.disabled=true;
btn.innerText="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...";

try{

const response=await fetch("https://script.google.com/macros/s/AKfycbw_CPNZhXWrBohJElT4FQE18qbovuwUlelKQMp9MFz052Z_ZCpqDX1u4PxfNA8SGPnPoA/exec?type=judges",{
method:"POST",
body:JSON.stringify({
group:currentGroup,
contestant:contestant.value,
judge:judge.value,
total:total,
theme:scores[0],
creative:scores[1],
standout:scores[2],
talent:scores[3],
personality:scores[4],
confidence:scores[5]
})
});

const result=await response.text();

if(result==="DUPLICATE"){
Swal.fire({icon:'error',title:'‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡πà‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏•‡πâ‡∏ß'});
}else{
Swal.fire({
icon:'success',
title:'‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à üéâ',
timer:1500,
showConfirmButton:false
});
document.querySelectorAll(".scoreInput").forEach(i=>i.value="");
calculateTotal();
}

}catch(err){
Swal.fire({icon:'error',title:'‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î'});
}

btn.disabled=false;
btn.innerText="‚úî ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô";
}

loadContestants();
loadTable();
</script>

</body>
</html>

