<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Back to School Voting - Login</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600&display=swap" rel="stylesheet">

<style>
body{
  font-family:'Prompt',sans-serif;
  overflow:hidden;
}

/* Gradient animation */
@keyframes gradientMove{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}
.animated-bg{
  background-size:300% 300%;
  animation:gradientMove 15s ease infinite;
}

/* Fade in */
@keyframes fadeUp{
  from{opacity:0; transform:translateY(20px)}
  to{opacity:1; transform:translateY(0)}
}
.fade-up{
  animation:fadeUp 1s ease forwards;
}

/* Button glow */
.glow-btn{
  position:relative;
  overflow:hidden;
}
.glow-btn::before{
  content:'';
  position:absolute;
  top:0;
  left:-100%;
  width:100%;
  height:100%;
  background:linear-gradient(120deg,transparent,rgba(255,255,255,0.5),transparent);
  transition:0.6s;
}
.glow-btn:hover::before{
  left:100%;
}

/* Particles */
canvas{
  position:absolute;
  top:0;
  left:0;
  z-index:0;
}
</style>
</head>

<body class="min-h-screen flex flex-col animated-bg
             bg-gradient-to-br from-pink-400 via-purple-400 to-blue-400">

<canvas id="particles"></canvas>

<div class="relative z-10 flex-grow flex items-center justify-center px-4">

<form onsubmit="login(event)"
class="fade-up w-full max-w-md
       bg-white/25 backdrop-blur-3xl
       border border-white/40
       shadow-[0_20px_60px_rgba(0,0,0,0.25)]
       rounded-3xl
       p-6 sm:p-8">

  <div class="text-center mb-8">
    <h2 class="text-3xl font-semibold text-white drop-shadow-lg">
      Login
    </h2>
    <p class="text-white/80 text-sm mt-2">
      เข้าสู่ระบบสำหรับกรรมการ
    </p>
  </div>

  <!-- Username -->
  <div class="relative mb-6">
    <input id="username" type="text" required
      class="peer w-full px-4 pt-5 pb-2 text-base rounded-xl
             bg-white/70 border border-white/60
             focus:outline-none focus:ring-2 focus:ring-pink-300
             placeholder-transparent"
      placeholder="Username">
    <label
      class="absolute left-4 top-2 text-sm text-gray-500 transition-all
             peer-placeholder-shown:top-3.5
             peer-placeholder-shown:text-base
             peer-placeholder-shown:text-gray-400
             peer-focus:top-2
             peer-focus:text-sm
             peer-focus:text-pink-500">
      Username
    </label>
  </div>

  <!-- Password -->
  <div class="relative mb-8">
    <input id="password" type="password" required
      class="peer w-full px-4 pt-5 pb-2 text-base rounded-xl
             bg-white/70 border border-white/60
             focus:outline-none focus:ring-2 focus:ring-purple-300
             placeholder-transparent"
      placeholder="Password">
    <label
      class="absolute left-4 top-2 text-sm text-gray-500 transition-all
             peer-placeholder-shown:top-3.5
             peer-placeholder-shown:text-base
             peer-placeholder-shown:text-gray-400
             peer-focus:top-2
             peer-focus:text-purple-500">
      Password
    </label>
  </div>

  <!-- Button -->
  <button id="loginBtn" type="submit"
    class="glow-btn w-full py-3 rounded-xl text-white font-medium
           bg-gradient-to-r from-pink-500 to-purple-600
           shadow-xl transition duration-300
           flex items-center justify-center gap-2">

    <span id="btnText">เข้าสู่ระบบ</span>

    <svg id="spinner" class="hidden animate-spin h-5 w-5 text-white"
         xmlns="http://www.w3.org/2000/svg" fill="none"
         viewBox="0 0 24 24">
      <circle class="opacity-25" cx="12" cy="12" r="10"
              stroke="currentColor" stroke-width="4"></circle>
      <path class="opacity-75" fill="currentColor"
            d="M4 12a8 8 0 018-8v8H4z"></path>
    </svg>
  </button>

</form>
</div>

<footer class="relative z-10 mt-auto text-center py-5 text-white/80 text-sm">
  © 2026 Back to School Event | Developed by Jakrayut Sangbunrueang
</footer>

<script>
const API="https://script.google.com/macros/s/AKfycbzwSy1VcfUtuWgOtD9pZwpVgYXFvWJ99_ZPw5JLDvmo1uf7vVrCj2hMDnnxLVMwEYGYcg/exec";

function login(event){
  event.preventDefault();

  const username=document.getElementById("username").value.trim().toLowerCase();
  const password=document.getElementById("password").value.trim();
  const btn=document.getElementById("loginBtn");
  const spinner=document.getElementById("spinner");
  const btnText=document.getElementById("btnText");

  if(!username||!password){
    Swal.fire({icon:'warning',title:'กรุณากรอกข้อมูลให้ครบ'});
    return;
  }

  btn.disabled=true;
  spinner.classList.remove("hidden");
  btnText.textContent="กำลังเข้าสู่ระบบ...";

  fetch(`${API}?action=login&username=${encodeURIComponent(username)}&password=${encodeURIComponent(password)}`)
  .then(res=>res.json())
  .then(data=>{
    if(data.status==="success"){
      localStorage.setItem("judge",data.judge);
      Swal.fire({icon:'success',title:'เข้าสู่ระบบสำเร็จ',timer:1200,showConfirmButton:false});
      setTimeout(()=>window.location.href="home.html",1200);
    }else throw new Error();
  })
  .catch(()=>{
    Swal.fire({icon:'error',title:'Login ไม่สำเร็จ',text:'Username หรือ Password ไม่ถูกต้อง'});
    btn.disabled=false;
    spinner.classList.add("hidden");
    btnText.textContent="เข้าสู่ระบบ";
  });
}

/* Particle background */
const canvas=document.getElementById("particles");
const ctx=canvas.getContext("2d");
canvas.width=window.innerWidth;
canvas.height=window.innerHeight;

let particles=[];
for(let i=0;i<60;i++){
  particles.push({
    x:Math.random()*canvas.width,
    y:Math.random()*canvas.height,
    r:Math.random()*2+1,
    d:Math.random()*1
  });
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle="rgba(255,255,255,0.5)";
  ctx.beginPath();
  particles.forEach(p=>{
    ctx.moveTo(p.x,p.y);
    ctx.arc(p.x,p.y,p.r,0,Math.PI*2,true);
  });
  ctx.fill();
  update();
}

function update(){
  particles.forEach(p=>{
    p.y+=p.d;
    if(p.y>canvas.height){
      p.y=0;
      p.x=Math.random()*canvas.width;
    }
  });
}

setInterval(draw,33);

window.addEventListener("resize",()=>{
  canvas.width=window.innerWidth;
  canvas.height=window.innerHeight;
});
</script>

</body>
</html>

