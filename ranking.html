<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üèÜ Ranking - Back to School</title>

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
body{
font-family:'Prompt',sans-serif;
background: linear-gradient(135deg,#fdfbfb,#ebedee);
}
.card{
background:white;
box-shadow:0 10px 25px rgba(0,0,0,0.05);
}
</style>
</head>

<body class="min-h-screen p-6 text-gray-700">

<h1 class="text-3xl font-bold text-center mb-10">
üèÜ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°‡πÅ‡∏¢‡∏Å‡∏ù‡πà‡∏≤‡∏¢
</h1>

<div class="grid md:grid-cols-2 gap-8 max-w-6xl mx-auto">

<!-- ‡∏ù‡πà‡∏≤‡∏¢‡∏´‡∏ç‡∏¥‡∏á -->
<div class="card rounded-2xl p-6">
<h2 class="text-xl font-semibold text-pink-500 mb-4 text-center">
üë© ‡∏ù‡πà‡∏≤‡∏¢‡∏´‡∏ç‡∏¥‡∏á
</h2>

<table class="w-full text-center">
<thead class="bg-pink-50">
<tr>
<th class="p-2">‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö</th>
<th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç</th>
<th>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°</th>
</tr>
</thead>
<tbody id="femaleBody"></tbody>
</table>
</div>

<!-- ‡∏ù‡πà‡∏≤‡∏¢‡∏ä‡∏≤‡∏¢ -->
<div class="card rounded-2xl p-6">
<h2 class="text-xl font-semibold text-blue-500 mb-4 text-center">
üë® ‡∏ù‡πà‡∏≤‡∏¢‡∏ä‡∏≤‡∏¢
</h2>

<table class="w-full text-center">
<thead class="bg-blue-50">
<tr>
<th class="p-2">‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö</th>
<th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç</th>
<th>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°</th>
</tr>
</thead>
<tbody id="maleBody"></tbody>
</table>
</div>

</div>

<script>

const sheetURL="https://script.google.com/macros/s/AKfycbzy7cnkwb6KowYl7U9d9c36WLXZ70AsN7EOW6rTEfjiGQjGFyoVDCYVx0FCur0ILZ54/exec";

async function loadRanking(){

const res = await fetch(sheetURL + "?t=" + new Date().getTime());
const data = await res.json();

let femaleScores = {};
let maleScores = {};

data.forEach(row=>{

let gender = row.group;
let num = row.contestant;
let total = parseInt(row.total) || 0;

if(gender==="female"){
if(!femaleScores[num]) femaleScores[num]=0;
femaleScores[num]+=total;
}

if(gender==="male"){
if(!maleScores[num]) maleScores[num]=0;
maleScores[num]+=total;
}

});

renderTable(femaleScores,"femaleBody","pink");
renderTable(maleScores,"maleBody","blue");

}

function renderTable(scores,bodyId,color){

let arr = Object.entries(scores)
.sort((a,b)=>b[1]-a[1]);

let medals=["ü•á","ü•à","ü•â"];
let html="";

arr.forEach((item,index)=>{

let medal = index<3 ? medals[index] : index+1;

html+=`
<tr class="border-b hover:bg-${color}-50 transition">
<td class="p-2 font-semibold">${medal}</td>
<td>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç ${item[0]}</td>
<td class="font-bold">${item[1]}</td>
</tr>`;
});

document.getElementById(bodyId).innerHTML = html;

}

loadRanking();
setInterval(loadRanking,5000);

</script>

</body>
</html>